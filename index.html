<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">–°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background:
                radial-gradient(1200px 800px at 10% 0%, rgba(230, 57, 70, 0.12), transparent 60%),
                radial-gradient(900px 700px at 90% 10%, rgba(181, 61, 70, 0.12), transparent 60%),
                linear-gradient(180deg, #0f0f10 0%, #151515 40%, #1a1a1a 100%);
            color: #e8e8e8;
        }
        
        .text-gradient-red {
            background-image: linear-gradient(to right, #e63946, #b53d46);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        #songList { counter-reset: list-counter; }
        .song-list-item { counter-increment: list-counter; transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease; }
        .song-list-item:hover { transform: translateY(-2px); border-color: rgba(230,57,70,.5); box-shadow: 0 10px 35px rgba(230,57,70,.18); }
        .song-list-item::before {
            content: counter(list-counter);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2.25rem;
            height: 2.25rem;
            margin-right: 1rem;
            border-radius: 9999px;
            background-image: linear-gradient(135deg, #e63946, #b53d46);
            color: #ffffff;
            font-weight: 700;
            box-shadow: 0 6px 20px rgba(230,57,70,.35);
            flex: 0 0 2.25rem;
        }

        .active-lang { background-image: linear-gradient(135deg, #e63946, #b53d46); box-shadow: 0 10px 30px rgba(230,57,70,.35); }

        #langMenu { opacity: 0; transform: translateY(-8px); pointer-events: none; transition: opacity .15s ease, transform .15s ease; }
        #langMenu.open { opacity: 1; transform: translateY(0); pointer-events: auto; }
        #lang-toggle { width: 2.75rem; height: 2.75rem; }

        @media (max-width: 480px) {
            body { padding-top: calc(4rem + constant(safe-area-inset-top)); padding-top: calc(4rem + env(safe-area-inset-top)); }
            .song-list-item { padding: 0.875rem; }
            .song-list-item::before { width: 2rem; height: 2rem; font-size: .9rem; }
        }
    </style>
</head>
<body class="p-6 md:p-12 pt-24 md:pt-32 flex flex-col items-center justify-center min-h-screen">

    <div class="absolute top-4 right-4">
        <div class="relative">
            <button id="lang-toggle" class="flex items-center justify-center rounded-full bg-gray-800 text-white shadow-lg ring-1 ring-white/10 hover:bg-gray-700 transition focus:outline-none focus:ring-2 focus:ring-red-500" aria-haspopup="true" aria-expanded="false" aria-controls="langMenu" title="–í—ã–±—Ä–∞—Ç—å —è–∑—ã–∫">
                <span class="text-xl leading-none">üåê</span>
            </button>
            <div id="langMenu" class="absolute right-0 mt-2 w-44 bg-gray-800/95 backdrop-blur rounded-xl shadow-xl border border-white/10 p-2 origin-top-right">
                <button id="lang-ru" class="w-full text-left px-3 py-3 rounded-lg text-white hover:bg-gray-700 transition">–†—É—Å—Å–∫–∏–π</button>
                <button id="lang-uk" class="w-full text-left px-3 py-3 rounded-lg text-white hover:bg-gray-700 transition">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
                <button id="lang-en" class="w-full text-left px-3 py-3 rounded-lg text-white hover:bg-gray-700 transition">English</button>
            </div>
        </div>
    </div>

    <header class="text-center mb-12">
        <h1 id="mainTitle" class="text-4xl md:text-5xl font-bold text-gradient-red mb-2"></h1>
        <p id="mainDescription" class="text-lg text-gray-400 max-w-2xl mx-auto"></p>
        <p class="text-lg text-white mt-4">
            <a href="https://www.tiktok.com/@apostrof_guitarist" target="_blank" class="hover:underline text-gradient-red">@apostrof_guitarist</a>
        </p>
    </header>

    <main class="w-full max-w-2xl">
        <ol id="songList" class="list-none p-0 space-y-4"></ol>
    </main>

    <script>
        // by apostrof_guitarist
        document.addEventListener('DOMContentLoaded', () => {
            const translations = {
                'ru': {
                    pageTitle: '–°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω',
                    mainTitle: '–ú–æ–π —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä',
                    mainDescription: '–ü—Ä–∏–≤–µ—Ç! –í—ã–±–∏—Ä–∞–π—Ç–µ –ø–µ—Å–Ω—é –ø–æ –Ω–æ–º–µ—Ä—É –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ.',
                    songsNotFound: '–°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω.',
                    songsEmpty: '–°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω –ø—É—Å—Ç.'
                },
                'uk': {
                    pageTitle: '–°–ø–∏—Å–æ–∫ –ø—ñ—Å–µ–Ω—å',
                    mainTitle: '–ú—ñ–π —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä',
                    mainDescription: '–ü—Ä–∏–≤—ñ—Ç! –û–±–∏—Ä–∞–π—Ç–µ –ø—ñ—Å–Ω—é –∑–∞ –Ω–æ–º–µ—Ä–æ–º –∑—ñ —Å–ø–∏—Å–∫—É –Ω–∏–∂—á–µ.',
                    songsNotFound: '–°–ø–∏—Å–æ–∫ –ø—ñ—Å–µ–Ω—å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.',
                    songsEmpty: '–°–ø–∏—Å–æ–∫ –ø—ñ—Å–µ–Ω—å –ø–æ—Ä–æ–∂–Ω—ñ–π.'
                },
                'en': {
                    pageTitle: 'Song List',
                    mainTitle: 'My Repertoire',
                    mainDescription: 'Hey! Choose a song by number from the list below.',
                    songsNotFound: 'Song list not found.',
                    songsEmpty: 'Song list is empty.'
                }
            };

            const listElement = document.getElementById('songList');

            async function updateUI(lang) {
                const textContent = translations[lang] || translations['ru'];

                try { localStorage.setItem('lang', lang); } catch (e) {}

                document.getElementById('pageTitle').textContent = textContent.pageTitle;
                document.getElementById('mainTitle').textContent = textContent.mainTitle;
                document.getElementById('mainDescription').textContent = textContent.mainDescription;

                // by apostrof_guitarist
                let songs = [];
                try {
                    const response = await fetch('songs.txt');
                    if (!response.ok) {
                        throw new Error(`Failed to load songs.txt: ${response.statusText}`);
                    }
                    const text = await response.text();
                    songs = text.split('\n')
                        .map(line => line.trim())
                        .filter(line => line.length > 0)
                        .map(line => {
                            const parts = line.split(' - ');
                            if (parts.length >= 2) {
                                return {
                                    artist: parts[0].trim(),
                                    title: parts.slice(1).join(' - ').trim()
                                };
                            }
                            return null;
                        })
                        .filter(song => song !== null);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ songs.txt. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', error);
                    listElement.innerHTML = `<li class="text-red-500 text-center">${textContent.songsNotFound}</li>`;
                    return;
                }

                listElement.innerHTML = '';
                if (songs.length === 0) {
                    listElement.innerHTML = `<li class="text-red-500 text-center">${textContent.songsEmpty}</li>`;
                } else {
                    songs.forEach(song => {
                        const listItem = document.createElement('li');
                        listItem.className = 'bg-gray-800/70 backdrop-blur rounded-2xl p-4 md:p-5 shadow-[0_8px_30px_rgba(0,0,0,0.12)] border border-white/10 flex items-center song-list-item';
                        listItem.innerHTML = `
                            <span class="text-xl text-white font-semibold flex-1">
                                ${song.title} - <span class="text-gray-400 font-normal">${song.artist}</span>
                            </span>
                        `;
                        listElement.appendChild(listItem);
                    });
                }

                setActiveLangButton(lang);
            }

            function setActiveLangButton(lang) {
                ['ru','uk','en'].forEach(code => {
                    const btn = document.getElementById('lang-' + code);
                    if (!btn) return;
                    if (code === lang) {
                        btn.classList.add('active-lang','ring-2','ring-red-500');
                    } else {
                        btn.classList.remove('active-lang','ring-2','ring-red-500');
                    }
                });
            }

            // by apostrof_guitarist
            const langToggle = document.getElementById('lang-toggle');
            const langMenu = document.getElementById('langMenu');

            function openMenu() {
                if (!langMenu) return;
                langMenu.classList.add('open');
                langToggle?.setAttribute('aria-expanded','true');
            }
            function closeMenu() {
                if (!langMenu) return;
                langMenu.classList.remove('open');
                langToggle?.setAttribute('aria-expanded','false');
            }
            function toggleMenu() {
                if (!langMenu) return;
                if (langMenu.classList.contains('open')) closeMenu(); else openMenu();
            }

            langToggle?.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleMenu();
            });

            document.getElementById('lang-ru').addEventListener('click', () => { updateUI('ru'); closeMenu(); });
            document.getElementById('lang-uk').addEventListener('click', () => { updateUI('uk'); closeMenu(); });
            document.getElementById('lang-en').addEventListener('click', () => { updateUI('en'); closeMenu(); });

            document.addEventListener('click', (e) => {
                if (!langMenu) return;
                if (!langMenu.contains(e.target) && e.target !== langToggle) {
                    closeMenu();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') closeMenu();
            });

            const savedLang = (() => { try { return localStorage.getItem('lang'); } catch(e) { return null; } })();

            const prefs = (Array.isArray(navigator.languages) && navigator.languages.length ? navigator.languages : [navigator.language]).filter(Boolean);

            function normalizeLang(code) {
                const base = String(code || '').toLowerCase().split('-')[0];
                if (base === 'ua') return 'uk';
                return base;
            }

            const initialLang = translations[savedLang] ? savedLang : (() => {
                for (const p of prefs) {
                    const c = normalizeLang(p);
                    if (translations[c]) return c;
                }
                return 'en';
            })();

            updateUI(initialLang);
        });
    </script>
</body>
</html>
